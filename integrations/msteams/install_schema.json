{
  "name": "Microsoft Teams",
  "description": "Send notifications to Teams channels via Graph API or Incoming Webhooks",
  "type": "notification",
  "fields": [
    {
      "name": "tenant_id",
      "label": "Azure AD Tenant ID",
      "type": "text",
      "required": false,
      "help": "For Graph API: Azure Portal > Azure AD > Overview > Directory (tenant) ID"
    },
    {
      "name": "client_id",
      "label": "Application (Client) ID",
      "type": "text",
      "required": false,
      "help": "For Graph API: App Registration > Overview > Application (client) ID"
    },
    {
      "name": "webhook_url",
      "label": "Webhook URL (optional)",
      "type": "password",
      "required": false,
      "env_var": "MSTEAMS_WEBHOOK_URL",
      "help": "For simple notifications: Incoming Webhook connector URL"
    }
  ],
  "post_install": [
    "",
    "GRAPH API SETUP (Recommended):",
    "1. Create App Registration in Azure Portal",
    "2. Add API permissions: User.Read.All, Team.ReadBasic.All,",
    "   Channel.ReadBasic.All, ChannelMessage.Send, ChatMessage.Send, Chat.Create",
    "3. Grant admin consent",
    "4. Enable 'Allow public client flows' in Authentication",
    "5. Run: rg msteams login",
    "",
    "WEBHOOK SETUP (Simple):",
    "- Just enter webhook URL above",
    "- Test with: rg notify 'Hello from RedGit!'"
  ],
  "links": {
    "graph_api_guide": "https://docs.microsoft.com/en-us/graph/api/resources/teams-api-overview",
    "webhook_guide": "https://docs.microsoft.com/en-us/microsoftteams/platform/webhooks-and-connectors/how-to/add-incoming-webhook",
    "app_registration": "https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade"
  }
}